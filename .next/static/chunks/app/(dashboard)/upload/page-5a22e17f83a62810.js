(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[394],{5475:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>h});var l=i(5155),t=i(2115),a=i(1593),r=i(408),o=i.n(r),d=i(7580),n=i(5525),c=i(1788),m=i(9869),x=i(7434);function h(){let[e,s]=(0,t.useState)("employee"),[i,r]=(0,t.useState)(!1),[h,p]=(0,t.useState)(0),[u,g]=(0,t.useState)(null),b=async e=>{let s=0,i=0,l=[];for(let h=0;h<e.length;h++){let u=e[h];try{var t,r,o,d,n,c,m,x;if(!u.kgid||!u.name||!u.mobile1||!u.district||!u.station){i++,l.push("Row ".concat(h+2,": Missing required fields (kgid, name, mobile1, district, station)"));continue}await (0,a.bV)({kgid:u.kgid.trim(),name:u.name.trim(),email:(null===(t=u.email)||void 0===t?void 0:t.trim())||"",mobile1:u.mobile1.trim(),mobile2:(null===(r=u.mobile2)||void 0===r?void 0:r.trim())||"",rank:(null===(o=u.rank)||void 0===o?void 0:o.trim())||"",metalNumber:(null===(d=u.metalNumber)||void 0===d?void 0:d.trim())||"",district:u.district.trim(),station:u.station.trim(),bloodGroup:(null===(n=u.bloodGroup)||void 0===n?void 0:n.trim())||"",photoUrl:(null===(c=u.photoUrl)||void 0===c?void 0:c.trim())||"",isAdmin:(null===(m=u.isAdmin)||void 0===m?void 0:m.toLowerCase())==="true",isApproved:(null===(x=u.isApproved)||void 0===x?void 0:x.toLowerCase())!=="false"}),s++}catch(e){i++,l.push("Row ".concat(h+2,": ").concat(e.message||"Unknown error"))}p(Math.round((h+1)/e.length*100))}return{success:s,failed:i,errors:l}},f=async e=>{let s=0,i=0,l=[];for(let o=0;o<e.length;o++){let d=e[o];try{var t,r;if(!d.agid||!d.name||!d.mobile||!d.district||!d.station){i++,l.push("Row ".concat(o+2,": Missing required fields (agid, name, mobile, district, station)"));continue}await (0,a.Zy)({rank:(null===(t=d.rank)||void 0===t?void 0:t.trim())||"",name:d.name.trim(),mobile:d.mobile.trim(),email:(null===(r=d.email)||void 0===r?void 0:r.trim())||void 0,district:d.district.trim(),office:d.station.trim()}),s++}catch(e){i++,l.push("Row ".concat(o+2,": ").concat(e.message||"Unknown error"))}p(Math.round((o+1)/e.length*100))}return{success:s,failed:i,errors:l}},j=async s=>{var i;let l=null===(i=s.target.files)||void 0===i?void 0:i[0];l&&(r(!0),p(0),g(null),o().parse(l,{header:!0,skipEmptyLines:!0,complete:async s=>{try{let i;if("employee"===e){let e=s.data;i=await b(e)}else{let e=s.data;i=await f(e)}g(i)}catch(e){console.error("Upload error:",e),g({success:0,failed:0,errors:["Upload failed: ".concat(e)]})}finally{r(!1)}},error:e=>{console.error("CSV parsing error:",e),alert("Failed to parse CSV file"),r(!1)}}))};return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h1",{className:"mb-6 text-3xl font-bold text-gray-900",children:"CSV Upload"}),(0,l.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,l.jsxs)("button",{onClick:()=>s("employee"),className:"flex items-center gap-2 rounded-lg px-6 py-3 font-medium transition-colors ".concat("employee"===e?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,l.jsx)(d.A,{className:"h-5 w-5"}),"Upload Employees"]}),(0,l.jsxs)("button",{onClick:()=>s("officer"),className:"flex items-center gap-2 rounded-lg px-6 py-3 font-medium transition-colors ".concat("officer"===e?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[(0,l.jsx)(n.A,{className:"h-5 w-5"}),"Upload Officers"]})]}),(0,l.jsxs)("div",{className:"rounded-lg bg-white p-6 shadow-md",children:[(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{className:"mb-2 text-xl font-semibold",children:["Upload ","employee"===e?"Employee":"Officer"," CSV"]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"employee"===e?"Upload a CSV file with employee data. Required columns: kgid, name, mobile1, district, station":"Upload a CSV file with officer data. Required columns: agid, name, mobile, district, station"})]}),(0,l.jsxs)("a",{href:"/templates/".concat("employee"===e?"employee_template.csv":"officer_template.csv"),download:!0,className:"flex items-center gap-2 rounded-lg border border-primary-600 bg-white px-4 py-2 text-primary-600 transition-colors hover:bg-primary-50",children:[(0,l.jsx)(c.A,{className:"h-5 w-5"}),"Download Template"]})]})}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsxs)("label",{className:"flex cursor-pointer items-center justify-center rounded-lg border-2 border-dashed border-gray-300 p-8 transition-colors hover:border-primary-500",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(m.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,l.jsx)("span",{className:"mt-2 block text-sm font-medium text-gray-700",children:i?"Uploading...":"Choose CSV file"}),(0,l.jsx)("span",{className:"mt-1 block text-xs text-gray-500",children:"CSV files only"})]}),(0,l.jsx)("input",{type:"file",accept:".csv",onChange:j,disabled:i,className:"hidden"})]})}),i&&(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"mb-2 flex items-center justify-between text-sm",children:[(0,l.jsx)("span",{children:"Uploading..."}),(0,l.jsxs)("span",{children:[h,"%"]})]}),(0,l.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-gray-200",children:(0,l.jsx)("div",{className:"h-full bg-primary-600 transition-all",style:{width:"".concat(h,"%")}})})]}),u&&(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("h3",{className:"mb-3 font-semibold",children:"Upload Results"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsxs)("span",{className:"font-medium text-green-600",children:["Success: ",u.success]})}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsxs)("span",{className:"font-medium text-red-600",children:["Failed: ",u.failed]})}),u.errors.length>0&&(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h4",{className:"mb-2 font-medium",children:"Errors:"}),(0,l.jsxs)("div",{className:"max-h-48 overflow-y-auto rounded bg-gray-50 p-2",children:[u.errors.slice(0,10).map((e,s)=>(0,l.jsx)("div",{className:"text-xs text-red-600",children:e},s)),u.errors.length>10&&(0,l.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["... and ",u.errors.length-10," more errors"]})]})]})]})]}),(0,l.jsxs)("div",{className:"mt-6 rounded-lg bg-gray-50 p-4",children:[(0,l.jsxs)("h3",{className:"mb-2 flex items-center gap-2 font-semibold",children:[(0,l.jsx)(x.A,{className:"h-5 w-5"}),"CSV Format - ","employee"===e?"Employees":"Officers"]}),"employee"===e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{className:"mb-2 text-sm text-gray-600",children:["Required columns: ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"kgid"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"name"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"mobile1"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"district"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"station"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Optional columns: email, mobile2, rank, metalNumber, bloodGroup, photoUrl, isAdmin, isApproved"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{className:"mb-2 text-sm text-gray-600",children:["Required columns: ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"agid"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"name"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"mobile"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"district"}),","," ",(0,l.jsx)("code",{className:"rounded bg-white px-1",children:"station"})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Optional columns: landline, rank, email, photoUrl"}),(0,l.jsxs)("div",{className:"mt-3 rounded bg-blue-50 p-3 text-xs text-blue-800",children:[(0,l.jsx)("strong",{children:"Note:"})," The ",(0,l.jsx)("code",{children:"station"})," column will be saved as the officer's ",(0,l.jsx)("code",{children:"office"})," field."]})]})]})]})]})}},9365:(e,s,i)=>{Promise.resolve().then(i.bind(i,5475))}},e=>{var s=s=>e(e.s=s);e.O(0,[135,563,521,351,974,441,684,358],()=>s(9365)),_N_E=e.O()}]);