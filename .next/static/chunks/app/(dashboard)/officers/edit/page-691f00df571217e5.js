(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[389],{1049:(e,r,a)=>{Promise.resolve().then(a.bind(a,1854))},1854:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>o});var t=a(5155),l=a(2115),i=a(5695),s=a(1593);function o(){let e=(0,i.useRouter)(),[r,a]=(0,l.useState)(""),[o,d]=(0,l.useState)(!1),[n,c]=(0,l.useState)(!0),[u,m]=(0,l.useState)(!1),[f,b]=(0,l.useState)([]),[p,x]=(0,l.useState)([]),[g,h]=(0,l.useState)([]),[k,v]=(0,l.useState)(""),[y,j]=(0,l.useState)({agid:"",rank:"",name:"",mobile:"",email:"",landline:"",district:"",office:""}),N=async()=>{if(r)try{let a=await (0,s.r4)(r);if(!a){alert("Officer not found"),e.push("/officers");return}j({agid:a.agid||a.cfd||"",rank:a.rank||"",name:a.name||"",mobile:a.mobile||"",email:a.email||"",landline:a.landline||"",district:a.district||"",office:a.office||""}),a.district&&v(a.district)}catch(r){console.error("Error loading officer:",r),alert("Failed to load officer"),e.push("/officers")}finally{c(!1)}},w=async()=>{try{let e=await (0,s.cM)();b(e)}catch(e){console.error("Error loading districts:",e)}},S=async()=>{try{let e=await (0,s.gG)();h(e)}catch(e){console.error("Error loading ranks:",e)}},E=async e=>{try{let r=await (0,s.OT)(e);x(r)}catch(e){console.error("Error loading stations:",e)}};(0,l.useEffect)(()=>{d(!0);let r=new URLSearchParams(window.location.search).get("id")||"";if(!r){alert("No officer ID provided"),e.push("/officers");return}a(r)},[e]),(0,l.useEffect)(()=>{r&&(async()=>{await w(),await S(),await N()})()},[r]),(0,l.useEffect)(()=>{k?E(k):x([])},[k]);let C=async a=>{if(a.preventDefault(),!r){alert("No officer ID provided");return}if(y.mobile&&10!==y.mobile.length){alert("Mobile number must be 10 digits");return}m(!0);try{await (0,s._Z)(r,{agid:y.agid.trim()||void 0,rank:y.rank.trim(),name:y.name.trim(),mobile:y.mobile.trim(),email:y.email.trim()||void 0,landline:y.landline.trim()||void 0,district:y.district,office:y.office.trim()||void 0}),e.push("/officers")}catch(e){console.error("Error updating officer:",e),alert("Failed to update officer")}finally{m(!1)}};return!o||n?(0,t.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,t.jsx)("div",{className:"text-lg text-slate-400",children:"Loading..."})}):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h1",{className:"mb-6 text-3xl font-bold text-slate-100",children:"Edit Officer"}),(0,t.jsxs)("form",{onSubmit:C,className:"rounded-lg bg-dark-card border border-dark-border p-6 shadow-lg",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"AGID"}),(0,t.jsx)("input",{type:"text",value:y.agid,onChange:e=>j({...y,agid:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",placeholder:"Auto-generated or enter manually"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Rank *"}),(0,t.jsxs)("select",{required:!0,value:y.rank,onChange:e=>j({...y,rank:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",children:[(0,t.jsx)("option",{value:"",children:"Select Rank"}),g.map(e=>(0,t.jsxs)("option",{value:e.equivalent_rank,children:[e.rank_label," (",e.equivalent_rank,")"]},e.rank_id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Name *"}),(0,t.jsx)("input",{type:"text",required:!0,value:y.name,onChange:e=>j({...y,name:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Mobile *"}),(0,t.jsx)("input",{type:"tel",required:!0,value:y.mobile,onChange:e=>j({...y,mobile:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Email"}),(0,t.jsx)("input",{type:"email",value:y.email,onChange:e=>j({...y,email:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Landline"}),(0,t.jsx)("input",{type:"tel",value:y.landline,onChange:e=>j({...y,landline:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",placeholder:"e.g., 08151-123456"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"District *"}),(0,t.jsxs)("select",{required:!0,value:k,onChange:e=>{v(e.target.value),j({...y,district:e.target.value,office:""})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",children:[(0,t.jsx)("option",{value:"",children:"Select District"}),f.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Station"}),(0,t.jsxs)("select",{value:y.office,onChange:e=>j({...y,office:e.target.value}),disabled:!k,className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50 disabled:bg-dark-accent-light disabled:text-slate-500",children:[(0,t.jsx)("option",{value:"",children:k?"Select Station":"Select District First"}),p.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"mt-6 flex gap-4",children:[(0,t.jsx)("button",{type:"submit",disabled:u,className:"rounded-lg bg-primary-600 px-6 py-2 text-white transition-colors hover:bg-primary-700 disabled:opacity-50",children:u?"Saving...":"Update Officer"}),(0,t.jsx)("button",{type:"button",onClick:()=>e.back(),className:"rounded-lg border border-dark-border px-6 py-2 text-slate-400 transition-colors hover:bg-dark-sidebar hover:text-slate-100",children:"Cancel"})]})]})]})}},5695:(e,r,a)=>{"use strict";var t=a(8999);a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})}},e=>{var r=r=>e(e.s=r);e.O(0,[135,563,521,974,441,684,358],()=>r(1049)),_N_E=e.O()}]);