(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[369],{883:(e,r,t)=>{"use strict";t.d(r,{_E:()=>l});let l=["A+","A-","B+","B-","AB+","AB-","O+","O-","??"]},4475:(e,r,t)=>{Promise.resolve().then(t.bind(t,7126))},5695:(e,r,t)=>{"use strict";var l=t(8999);t.o(l,"usePathname")&&t.d(r,{usePathname:function(){return l.usePathname}}),t.o(l,"useRouter")&&t.d(r,{useRouter:function(){return l.useRouter}})},7126:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var l=t(5155),a=t(2115),s=t(5695),o=t(1593),i=t(883);function d(){let e=(0,s.useRouter)(),[r,t]=(0,a.useState)(!1),[d,n]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[m,b]=(0,a.useState)([]),[p,x]=(0,a.useState)(""),[h,f]=(0,a.useState)({kgid:"",name:"",email:"",mobile1:"",mobile2:"",rank:"",metalNumber:"",district:"",station:"",bloodGroup:"",photoUrl:"",isAdmin:!1,isApproved:!0});(0,a.useEffect)(()=>{g(),v()},[]),(0,a.useEffect)(()=>{p?k(p):u([])},[p]);let g=async()=>{try{let e=await (0,o.cM)();console.log("Loaded districts:",e),n(e),0===e.length&&console.warn("No districts found. Make sure districts exist in Firestore.")}catch(e){console.error("Error loading districts:",e),alert("Failed to load districts. Please check the console for details.")}},k=async e=>{try{console.log("Loading stations for district:",e);let r=await (0,o.OT)(e);console.log("Loaded stations:",r),u(r),0===r.length&&console.warn("No stations found for district: ".concat(e))}catch(r){console.error("Error loading stations:",r),alert("Failed to load stations for ".concat(e,". Please check the console for details."))}},v=async()=>{try{let e=await (0,o.gG)();console.log("Loaded ranks:",e),b(e),0===e.length&&console.warn("No ranks found. Make sure ranks exist in Firestore.")}catch(e){console.error("Error loading ranks:",e),alert("Failed to load ranks. Please check the console for details.")}},y=e=>m.find(r=>{var t;return r.equivalent_rank===e||(null===(t=r.aliases)||void 0===t?void 0:t.includes(e))||r.rank_id===e}),j=e=>{let r=y(e);return(null==r?void 0:r.requiresMetalNumber)||!1},N=async r=>{var l;if(r.preventDefault(),h.rank&&j(h.rank)&&!(null===(l=h.metalNumber)||void 0===l?void 0:l.trim())){alert("Metal number is required for rank: ".concat(h.rank));return}if(h.mobile1&&10!==h.mobile1.length){alert("Mobile number must be 10 digits");return}t(!0);try{await (0,o.bV)(h),e.push("/employees")}catch(e){console.error("Error creating employee:",e),alert("Failed to create employee")}finally{t(!1)}};return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h1",{className:"mb-6 text-3xl font-bold text-slate-100",children:"Add New Employee"}),(0,l.jsxs)("form",{onSubmit:N,className:"rounded-lg bg-dark-card border border-dark-border p-6 shadow-lg",style:{overflow:"visible"},children:[(0,l.jsx)("h2",{className:"mb-4 text-xl font-semibold text-slate-100",children:"Employee Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",style:{overflow:"visible"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Name *"}),(0,l.jsx)("input",{type:"text",required:!0,value:h.name,onChange:e=>f({...h,name:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Email *"}),(0,l.jsx)("input",{type:"email",required:!0,value:h.email,onChange:e=>f({...h,email:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Mobile 1 *"}),(0,l.jsx)("input",{type:"tel",required:!0,value:h.mobile1,onChange:e=>{let r=e.target.value.replace(/\D/g,"").slice(0,10);f({...h,mobile1:r})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Mobile 2 (Optional)"}),(0,l.jsx)("input",{type:"tel",value:h.mobile2,onChange:e=>{let r=e.target.value.replace(/\D/g,"").slice(0,10);f({...h,mobile2:r})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"KGID *"}),(0,l.jsx)("input",{type:"text",required:!0,value:h.kgid,onChange:e=>{let r=e.target.value.replace(/\D/g,"");f({...h,kgid:r})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Rank *"}),(0,l.jsxs)("select",{required:!0,value:h.rank,onChange:e=>{let r=e.target.value,t=h.metalNumber&&(!r||!j(r));f({...h,rank:r,metalNumber:t?"":h.metalNumber})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",children:[(0,l.jsx)("option",{value:"",children:"Select Rank"}),m.map(e=>(0,l.jsxs)("option",{value:e.equivalent_rank,children:[e.rank_label," (",e.equivalent_rank,")"]},e.rank_id))]})]}),h.rank&&j(h.rank)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Metal Number *"}),(0,l.jsx)("input",{type:"text",required:!0,value:h.metalNumber,onChange:e=>f({...h,metalNumber:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-red-400 px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/50"}),(0,l.jsx)("p",{className:"mt-1 text-xs text-red-400 font-medium",children:"âš  Required for this rank"})]}),(0,l.jsxs)("div",{className:"relative",style:{zIndex:10},children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"District *"}),(0,l.jsxs)("select",{required:!0,value:p,onChange:e=>{x(e.target.value),f({...h,district:e.target.value,station:""})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",style:{zIndex:1e3,position:"relative"},children:[(0,l.jsx)("option",{value:"",children:"Select District"}),d.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:"relative",style:{zIndex:10},children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Station *"}),(0,l.jsxs)("select",{required:!0,value:h.station,onChange:e=>f({...h,station:e.target.value}),disabled:!p,className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50 disabled:bg-dark-accent-light disabled:text-slate-500",style:{zIndex:1e3,position:"relative"},children:[(0,l.jsx)("option",{value:"",children:p?"Select Station":"Select District First"}),c.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Blood Group"}),(0,l.jsxs)("select",{value:h.bloodGroup,onChange:e=>f({...h,bloodGroup:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",children:[(0,l.jsx)("option",{value:"",children:"Select Blood Group"}),i._E.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Photo URL"}),(0,l.jsx)("input",{type:"url",value:h.photoUrl,onChange:e=>f({...h,photoUrl:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",placeholder:"https://..."})]}),(0,l.jsxs)("div",{className:"flex gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"isAdmin",checked:h.isAdmin,onChange:e=>f({...h,isAdmin:e.target.checked}),className:"h-4 w-4 rounded border-dark-border bg-dark-sidebar text-primary-600 focus:ring-primary-500"}),(0,l.jsx)("label",{htmlFor:"isAdmin",className:"ml-2 text-sm font-medium text-slate-400",children:"Is Admin"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",id:"isApproved",checked:h.isApproved,onChange:e=>f({...h,isApproved:e.target.checked}),className:"h-4 w-4 rounded border-dark-border bg-dark-sidebar text-primary-600 focus:ring-primary-500"}),(0,l.jsx)("label",{htmlFor:"isApproved",className:"ml-2 text-sm font-medium text-slate-400",children:"Is Approved"})]})]})]}),(0,l.jsxs)("div",{className:"mt-6 flex gap-4",children:[(0,l.jsx)("button",{type:"submit",disabled:r,className:"rounded-lg bg-primary-600 px-6 py-2 text-white transition-colors hover:bg-primary-700 disabled:opacity-50",children:r?"Saving...":"Save Employee"}),(0,l.jsx)("button",{type:"button",onClick:()=>e.back(),className:"rounded-lg border border-dark-border px-6 py-2 text-slate-400 transition-colors hover:bg-dark-sidebar hover:text-slate-100",children:"Cancel"})]})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[135,563,521,974,441,684,358],()=>r(4475)),_N_E=e.O()}]);