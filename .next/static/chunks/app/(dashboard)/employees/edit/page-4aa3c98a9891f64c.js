(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{883:(e,r,t)=>{"use strict";t.d(r,{_E:()=>l});let l=["A+","A-","B+","B-","AB+","AB-","O+","O-","??"]},4665:(e,r,t)=>{Promise.resolve().then(t.bind(t,9724))},5695:(e,r,t)=>{"use strict";var l=t(8999);t.o(l,"usePathname")&&t.d(r,{usePathname:function(){return l.usePathname}}),t.o(l,"useRouter")&&t.d(r,{useRouter:function(){return l.useRouter}})},9724:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var l=t(5155),a=t(2115),s=t(5695),o=t(1593),i=t(883);function d(){var e,r,t;let d=(0,s.useRouter)(),[n,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),[b,p]=(0,a.useState)(!0),[x,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)([]),[v,k]=(0,a.useState)([]),[y,N]=(0,a.useState)([]),[j,w]=(0,a.useState)(""),[C,E]=(0,a.useState)({kgid:"",name:"",email:"",mobile1:"",mobile2:"",rank:"",metalNumber:"",district:"",station:"",bloodGroup:"",photoUrl:"",isAdmin:!1,isApproved:!0});(0,a.useEffect)(()=>{m(!0);let e=new URLSearchParams(window.location.search).get("id")||"";if(!e){alert("No employee ID provided"),d.push("/employees");return}c(e)},[d]),(0,a.useEffect)(()=>{n&&(A(),q(),S())},[n]),(0,a.useEffect)(()=>{if(j&&!b){var e;let r=null===(e=v[0])||void 0===e?void 0:e.district;(0===v.length||r&&r!==j)&&G(j)}else j||b||k([])},[j,b]),(0,a.useEffect)(()=>{v.length>0&&C.station&&!v.some(e=>e.name===C.station)&&C.station&&k(e=>e.some(e=>e.name===C.station)?e:[...e,{id:"current",name:C.station,district:j||""}])},[v,C.station,j]);let S=async()=>{if(n)try{var e,r,t,l,a,s,i,c,u,m,b,x;let p=await (0,o.l3)(n);if(!p){alert("Employee not found"),d.push("/employees");return}let h=null!==(e=p.station)&&void 0!==e?e:"",g=null!==(r=p.district)&&void 0!==r?r:"",f=null!==(t=p.bloodGroup)&&void 0!==t?t:"";if(g){let e=await (0,o.OT)(g),r=h.trim(),t=e.some(e=>e.name.trim().toLowerCase()===r.toLowerCase());r&&!t&&e.push({id:"current",name:r,district:g}),k(e),w(g)}E({kgid:null!==(l=p.kgid)&&void 0!==l?l:"",name:null!==(a=p.name)&&void 0!==a?a:"",email:null!==(s=p.email)&&void 0!==s?s:"",mobile1:null!==(i=p.mobile1)&&void 0!==i?i:"",mobile2:null!==(c=p.mobile2)&&void 0!==c?c:"",rank:null!==(u=p.rank)&&void 0!==u?u:"",metalNumber:null!==(m=p.metalNumber)&&void 0!==m?m:"",district:g,station:h,bloodGroup:f,photoUrl:null!==(b=p.photoUrl)&&void 0!==b?b:"",isAdmin:null!==(x=p.isAdmin)&&void 0!==x&&x,isApproved:void 0===p.isApproved||p.isApproved})}catch(e){console.error("Error loading employee:",e),alert("Failed to load employee"),d.push("/employees")}finally{p(!1)}},A=async()=>{try{let e=await (0,o.cM)();f(e)}catch(e){console.error("Error loading districts:",e)}},q=async()=>{try{let e=await (0,o.gG)();N(e)}catch(e){console.error("Error loading ranks:",e)}},_=e=>y.find(r=>{var t;return r.equivalent_rank===e||(null===(t=r.aliases)||void 0===t?void 0:t.includes(e))||r.rank_id===e}),D=e=>{let r=_(e);return(null==r?void 0:r.requiresMetalNumber)||!1},G=async e=>{try{let r=await (0,o.OT)(e);k(r)}catch(e){console.error("Error loading stations:",e)}},I=async e=>{var r;if(e.preventDefault(),!n){alert("No employee ID provided");return}if(C.rank&&D(C.rank)&&!(null===(r=C.metalNumber)||void 0===r?void 0:r.trim())){alert("Metal number is required for rank: ".concat(C.rank));return}if(C.mobile1&&10!==C.mobile1.length){alert("Mobile number must be 10 digits");return}h(!0);try{await (0,o.Y$)(n,C),d.push("/employees")}catch(e){console.error("Error updating employee:",e),alert("Failed to update employee")}finally{h(!1)}};return!u||b?(0,l.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,l.jsx)("div",{className:"text-lg text-slate-400",children:"Loading..."})}):(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h1",{className:"mb-6 text-3xl font-bold text-slate-100",children:"Edit Employee"}),(0,l.jsxs)("form",{onSubmit:I,className:"rounded-lg bg-dark-card border border-dark-border p-6 shadow-lg",style:{overflow:"visible"},children:[(0,l.jsx)("h2",{className:"mb-4 text-xl font-semibold text-slate-100",children:"Employee Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",style:{overflow:"visible"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Name *"}),(0,l.jsx)("input",{type:"text",required:!0,value:C.name,onChange:e=>E({...C,name:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Email *"}),(0,l.jsx)("input",{type:"email",required:!0,value:C.email,onChange:e=>E({...C,email:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Mobile 1 *"}),(0,l.jsx)("input",{type:"tel",required:!0,value:C.mobile1,onChange:e=>{let r=e.target.value.replace(/\D/g,"").slice(0,10);E({...C,mobile1:r})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Mobile 2 (Optional)"}),(0,l.jsx)("input",{type:"tel",value:C.mobile2,onChange:e=>{let r=e.target.value.replace(/\D/g,"").slice(0,10);E({...C,mobile2:r})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"KGID *"}),(0,l.jsx)("input",{type:"text",required:!0,value:C.kgid,onChange:e=>{let r=e.target.value.replace(/\D/g,"");E({...C,kgid:r})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Rank *"}),(0,l.jsxs)("select",{required:!0,value:C.rank,onChange:e=>{let r=e.target.value,t=C.metalNumber&&(!r||!D(r));E({...C,rank:r,metalNumber:t?"":C.metalNumber})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",children:[(0,l.jsx)("option",{value:"",children:"Select Rank"}),y.map(e=>(0,l.jsxs)("option",{value:e.equivalent_rank,children:[e.rank_label," (",e.equivalent_rank,")"]},e.rank_id))]})]}),C.rank&&D(C.rank)&&(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Metal Number *"}),(0,l.jsx)("input",{type:"text",required:!0,value:C.metalNumber,onChange:e=>E({...C,metalNumber:e.target.value}),className:"mt-1 block w-full rounded-md border px-3 py-2 focus:outline-none focus:ring-2 ".concat((null===(e=C.metalNumber)||void 0===e?void 0:e.trim())?"border-dark-border focus:border-primary-400 focus:ring-primary-400/50":"border-amber-300 focus:border-amber-500 focus:ring-amber-500")}),(0,l.jsx)("p",{className:"mt-1 text-xs font-medium ".concat((null===(r=C.metalNumber)||void 0===r?void 0:r.trim())?"text-slate-500":"text-amber-600"),children:(null===(t=C.metalNumber)||void 0===t?void 0:t.trim())?"✓ Metal number provided":"⚠ Required for this rank"})]})]}),(0,l.jsxs)("div",{className:"relative",style:{zIndex:10},children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"District *"}),(0,l.jsxs)("select",{required:!0,value:j,onChange:e=>{w(e.target.value),E({...C,district:e.target.value,station:""})},className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",style:{zIndex:1e3,position:"relative"},children:[(0,l.jsx)("option",{value:"",children:"Select District"}),g.map(e=>(0,l.jsx)("option",{value:e.name,style:{backgroundColor:"white",color:"black"},children:e.name},e.id))]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,l.jsxs)("div",{className:"relative",style:{zIndex:10},children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Station *"}),(0,l.jsxs)("select",{required:!0,value:C.station,onChange:e=>E({...C,station:e.target.value}),disabled:!j,className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50 disabled:bg-dark-accent-light disabled:text-slate-500",style:{zIndex:1e3,position:"relative"},children:[(0,l.jsx)("option",{value:"",children:j?"Select Station":"Select District First"}),v.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id||e.name))]},"station-".concat(v.length,"-").concat(C.station))]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Blood Group"}),(0,l.jsxs)("select",{value:C.bloodGroup,onChange:e=>E({...C,bloodGroup:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50",children:[(0,l.jsx)("option",{value:"",children:"Select Blood Group"}),i._E.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-slate-400",children:"Photo URL"}),(0,l.jsx)("input",{type:"url",value:C.photoUrl,onChange:e=>E({...C,photoUrl:e.target.value}),className:"mt-1 block w-full rounded-md bg-dark-sidebar border border-dark-border px-3 py-2 text-slate-100 placeholder-slate-400 focus:border-primary-400 focus:outline-none focus:ring-2 focus:ring-primary-400/50"})]})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center gap-4",children:[(0,l.jsxs)("label",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:C.isAdmin,onChange:e=>E({...C,isAdmin:e.target.checked}),className:"mr-2 rounded border-dark-border bg-dark-sidebar text-primary-600 focus:ring-primary-500"}),(0,l.jsx)("span",{className:"text-sm text-slate-400",children:"Is Admin"})]}),(0,l.jsxs)("label",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:C.isApproved,onChange:e=>E({...C,isApproved:e.target.checked}),className:"mr-2 rounded border-dark-border bg-dark-sidebar text-primary-600 focus:ring-primary-500"}),(0,l.jsx)("span",{className:"text-sm text-slate-400",children:"Is Approved"})]})]}),(0,l.jsxs)("div",{className:"mt-6 flex gap-4",children:[(0,l.jsx)("button",{type:"submit",disabled:x,className:"rounded-lg bg-primary-600 px-6 py-2 text-white transition-colors hover:bg-primary-700 disabled:opacity-50",children:x?"Saving...":"Update Employee"}),(0,l.jsx)("button",{type:"button",onClick:()=>d.back(),className:"rounded-lg border border-dark-border px-6 py-2 text-slate-400 transition-colors hover:bg-dark-sidebar hover:text-slate-100",children:"Cancel"})]})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[135,563,521,974,441,684,358],()=>r(4665)),_N_E=e.O()}]);