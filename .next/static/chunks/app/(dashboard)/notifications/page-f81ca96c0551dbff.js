(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[317],{3420:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(5155),i=r(2115),s=r(1593),l=r(5525),o=r(7580);let n=(0,r(9946).A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);function c(){let[e,t]=(0,i.useState)("admin"),[r,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)([]),[m,g]=(0,i.useState)([]),[y,x]=(0,i.useState)(""),[p,b]=(0,i.useState)({title:"",body:""}),[f,h]=(0,i.useState)({title:"",body:"",targetType:"ALL",targetKgid:"",targetDistrict:"",targetStation:""});(0,i.useEffect)(()=>{v()},[]),(0,i.useEffect)(()=>{y&&("STATION"===f.targetType||"DISTRICT"===f.targetType)?j(y):g([])},[y,f.targetType]);let v=async()=>{try{let e=await (0,s.cM)();u(e)}catch(e){console.error("Error loading districts:",e)}},j=async e=>{try{let t=await (0,s.OT)(e);g(t)}catch(e){console.error("Error loading stations:",e)}},N=async e=>{if(e.preventDefault(),!p.title.trim()||!p.body.trim()){alert("Please fill in both title and message fields");return}c(!0);try{let e={title:p.title.trim(),body:p.body.trim(),targetType:"ADMIN"};console.log("\uD83D\uDCE4 Creating admin notification:",e);let t=await (0,s.UI)(e,!0);console.log("✅ Admin notification created with ID:",t),alert("Admin notification queued successfully! It will be sent shortly."),b({title:"",body:""})}catch(e){console.error("❌ Error creating admin notification:",e),console.error("❌ Error details:",{message:null==e?void 0:e.message,code:null==e?void 0:e.code,stack:null==e?void 0:e.stack}),alert("Failed to create admin notification: ".concat((null==e?void 0:e.message)||"Unknown error"))}finally{c(!1)}},S=async e=>{if(e.preventDefault(),!f.title.trim()||!f.body.trim()){alert("Please fill in both title and message fields");return}c(!0);try{let e={title:f.title.trim(),body:f.body.trim(),targetType:f.targetType};if("SINGLE"===f.targetType){var t;if(!(null===(t=f.targetKgid)||void 0===t?void 0:t.trim())){alert("Please enter a KGID for single user notification"),c(!1);return}e.targetKgid=f.targetKgid.trim()}else if("STATION"===f.targetType){if(!f.targetDistrict||!f.targetStation){alert("Please select both district and station"),c(!1);return}e.targetDistrict=f.targetDistrict,e.targetStation=f.targetStation}else if("DISTRICT"===f.targetType){if(!f.targetDistrict){alert("Please select a district"),c(!1);return}e.targetDistrict=f.targetDistrict}console.log("\uD83D\uDCE4 Creating user notification:",e);let r=await (0,s.UI)(e,!1);console.log("✅ User notification created with ID:",r),alert("User notification queued successfully! It will be sent shortly."),h({title:"",body:"",targetType:"ALL",targetKgid:"",targetDistrict:"",targetStation:""}),x(""),g([])}catch(e){console.error("❌ Error creating user notification:",e),console.error("❌ Error details:",{message:null==e?void 0:e.message,code:null==e?void 0:e.code,stack:null==e?void 0:e.stack}),alert("Failed to create user notification: ".concat((null==e?void 0:e.message)||"Unknown error"))}finally{c(!1)}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h1",{className:"mb-6 text-3xl font-bold text-gray-900",children:"Notifications"}),(0,a.jsx)("div",{className:"mb-6 border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsxs)("button",{onClick:()=>t("admin"),className:"flex items-center gap-2 border-b-2 px-1 py-4 text-sm font-medium ".concat("admin"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[(0,a.jsx)(l.A,{className:"h-5 w-5"}),"Send to Admins"]}),(0,a.jsxs)("button",{onClick:()=>t("users"),className:"flex items-center gap-2 border-b-2 px-1 py-4 text-sm font-medium ".concat("users"===e?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[(0,a.jsx)(o.A,{className:"h-5 w-5"}),"Send to Users"]})]})}),"admin"===e&&(0,a.jsxs)("form",{onSubmit:N,className:"rounded-lg bg-white p-6 shadow-md",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-gray-700",children:[(0,a.jsx)(l.A,{className:"h-5 w-5 text-primary-600"}),(0,a.jsx)("span",{children:"Send Notification to Admins"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Title *"}),(0,a.jsx)("input",{type:"text",required:!0,value:p.title,onChange:e=>b({...p,title:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Message *"}),(0,a.jsx)("textarea",{required:!0,rows:4,value:p.body,onChange:e=>b({...p,body:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("button",{type:"submit",disabled:r,className:"flex items-center gap-2 rounded-lg bg-primary-600 px-6 py-2 text-white transition-colors hover:bg-primary-700 disabled:opacity-50",children:[(0,a.jsx)(n,{className:"h-5 w-5"}),r?"Sending...":"Send to Admins"]})]})]}),"users"===e&&(0,a.jsxs)("form",{onSubmit:S,className:"rounded-lg bg-white p-6 shadow-md",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2 text-lg font-semibold text-gray-700",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-primary-600"}),(0,a.jsx)("span",{children:"Send Notification to Users"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Title *"}),(0,a.jsx)("input",{type:"text",required:!0,value:f.title,onChange:e=>h({...f,title:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Message *"}),(0,a.jsx)("textarea",{required:!0,rows:4,value:f.body,onChange:e=>h({...f,body:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Target Audience *"}),(0,a.jsxs)("select",{required:!0,value:f.targetType,onChange:e=>h({...f,targetType:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"ALL",children:"All Users"}),(0,a.jsx)("option",{value:"DISTRICT",children:"By District"}),(0,a.jsx)("option",{value:"STATION",children:"By Station"}),(0,a.jsx)("option",{value:"SINGLE",children:"Single User (KGID)"})]})]}),"SINGLE"===f.targetType&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"KGID *"}),(0,a.jsx)("input",{type:"text",required:!0,value:f.targetKgid,onChange:e=>h({...f,targetKgid:e.target.value}),className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),"DISTRICT"===f.targetType&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"District *"}),(0,a.jsxs)("select",{required:!0,value:y,onChange:e=>{x(e.target.value),h({...f,targetDistrict:e.target.value})},className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Select District"}),d.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),"STATION"===f.targetType&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"District *"}),(0,a.jsxs)("select",{required:!0,value:y,onChange:e=>{x(e.target.value),h({...f,targetDistrict:e.target.value,targetStation:""})},className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"",children:"Select District"}),d.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Station *"}),(0,a.jsxs)("select",{required:!0,value:f.targetStation,onChange:e=>h({...f,targetStation:e.target.value}),disabled:!y,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 focus:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:bg-gray-100 disabled:text-gray-500",children:[(0,a.jsx)("option",{value:"",children:y?"Select Station":"Select District First"}),m.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]}),(0,a.jsxs)("button",{type:"submit",disabled:r,className:"flex items-center gap-2 rounded-lg bg-primary-600 px-6 py-2 text-white transition-colors hover:bg-primary-700 disabled:opacity-50",children:[(0,a.jsx)(n,{className:"h-5 w-5"}),r?"Sending...":"Send to Users"]})]})]})]})}},4746:(e,t,r)=>{Promise.resolve().then(r.bind(r,3420))},5525:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9946).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},7580:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(9946).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},9946:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(2115);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:n,className:c="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...l,width:i,height:i,stroke:r,strokeWidth:n?24*Number(o)/Number(i):o,className:s("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),n=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:n,...c}=r;return(0,a.createElement)(o,{ref:l,iconNode:t,className:s("lucide-".concat(i(e)),n),...c})});return r.displayName="".concat(e),r}}},e=>{var t=t=>e(e.s=t);e.O(0,[135,563,521,974,441,684,358],()=>t(4746)),_N_E=e.O()}]);